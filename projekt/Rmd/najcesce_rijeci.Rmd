---
title: "najcesce_rijeci"
output: html_document
date: "2024-01-23"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library("tidyverse")
library("tidytext")
library("tm")
```

Ucitavanje podataka i čišćenje od znakova:

```{r}
data <- read.csv("../data/complete.csv")
head(data)

data$comments <- gsub("&#\\d+|&quot;|&amp;", " ", data$comments)


symbols <- c(",", ".", "/")
data$comments <- sapply(data$comments, function(comment) {
  # Remove additional symbols
  for (symbol in symbols) {
    comment <- gsub(symbol, " ", comment, fixed = TRUE)
  }
  
  return(comment)
})

head(data, 20)
```

Izvlacenje rijeci i njihove frekvencije, micanje stopwords

```{r}

comments <-  data$comments



rijeci <- data.frame(table(unlist(strsplit(tolower(comments), " "))))


# Rename columns for clarity
colnames(rijeci) <- c("Word", "Freq")

# Remove English stopwords
stopwords <- stopwords("en")
rijeci <- rijeci %>%
  filter(!Word %in% c(stopwords, ""))


# Arrange by frequency in descending order
rijeci <- rijeci %>%
  arrange(desc(Freq))
rijeci
```

